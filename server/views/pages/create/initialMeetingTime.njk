{% extends "layout.njk" %}

{#
  Passed into to this template:
  - formResponses - is an object containing entered values (validation failed) for inductionDate, inductionTime
  - formDate - is an object containing the current values from the API (if any) for inductionDate, inductionTime
#}

{% from "../../partials/timePicker.njk" import timePicker %}
{% from "customComponents/datePicker/macro.njk" import hmppsDatePicker %}


{% set pageTitle = applicationName + " - Create a licence - When is the initial appointment?" %}
{% set pageId = "appointment-time-page" %}
{% set backLinkHref = "/licence/create/id/" + licence.id + "/initial-meeting-contact" %}

{% block content %}
    <form method="POST">
        <input type="hidden" name="_csrf" value="{{ csrfToken }}">
        <div class="govuk-grid-row">
            <div class="govuk-grid-column-full">

                {% call govukFieldset({
                    legend: {
                        text: "When is the initial appointment?",
                        classes: "govuk-fieldset__legend--l",
                        isPageHeading: true
                    }
                    }) %}

                    {% if releaseIsOnBankHolidayOrWeekend %}
                        {{ govukWarningText({
                            text: "The release date is on a weekend or bank holiday. Check the release date with the prison OMU.",
                            iconFallbackText: "Warning"
                        }) }}
                    {% endif %}

                    {{ hmppsDatePicker({
                        id: "date-calendarDate",
                        name: "date[calendarDate]",
                        label: {
                            text: "Date"
                        },
                        hint: {
                            id: "date-hint",
                            text: "For example, 12/11/2024"
                        },
                        errorMessage: validationErrors | findError('date'),
                        classes: 'hmpps-datepicker--fixed-width',
                        value: formResponses.date.calendarDate or formDate.date.calendarDate
                    }) }}
                {% endcall %}
                
                {% call govukFieldset({
                    classes:"govuk-!-margin-top-7",

                    legend: {
                        text: "Time",
                        classes: "govuk-visually-hidden",
                        isPageHeading: false}
                    }) %}
                
                    {{ timePicker({
                        id: "time",
                        label: {
                            text: "Time"
                        },
                        hint: {
                            id: "time-hint",
                            text: "For example, 9:30am or 2:55pm"
                        },
                        errorMessage: validationErrors | findError('time'),
                        formResponses: formResponses.time or formDate.time
                    }) }}
                {% endcall %}

                <div class="govuk-button-group">
                    {{ govukButton({
                        text: continueOrReturnToCheckAnswers,
                        type: "submit",
                        attributes: { 'data-qa': 'continue' }
                    }) }}
                    {{ govukButton({
                        text: 'Skip this for now',
                        href: skipUrl,
                        classes: "govuk-button--secondary",
                        attributes: { 'data-qa': 'skip' }
                    }) }}
                </div>
            </div>
        </div>
    </form>
{% endblock %}

{% block pageScripts %}
   <script src="/assets/js/datepicker.js"></script>
{% endblock %}

